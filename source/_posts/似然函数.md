---
title: 似然函数
date: 2018-08-22 16:41:52
tags:
  - 统计学
  - 机器学习
mathjax: true
---

本文主要解释了似然的概念，似然和概率的区别和联系。

<!-- more -->

> 本文主要参考了以下链接，对其进行了部分简化和总结
>
> https://baike.baidu.com/item/似然函数/6011241
> https://www.zhihu.com/question/54082000/answer/145495695
> https://www.cnblogs.com/zhsuiy/p/4822020.html

#### 1. 似然与概率的区别

似然 (likehood) 与概率 (probability) 在英语语境中是可以互换的。但是在统计学中，二者有截然不同的用法。

概率描述了已知参数时的随机变量的输出结果；似然则用来描述已知随机变量输出结果时，**未知参数的可能取值**。

例如，对于“一枚正反对称的硬币上抛十次”这种事件，我们可以问硬币落地时十次都是正面向上的“概率”是多少；而对于“一枚硬币上抛十次”，我们则可以问，这枚硬币正反面对称的“似然”程度是多少。

区别似然和概率的直接方法为，"谁谁谁的概率"中**谁谁谁只能是事件**，也就是，事件(发生)的概率是多少；而"谁谁谁的似然"中的**谁谁谁只能是参数**，比如说，参数等于某个值时的似然是多少。

#### 2. 似然与概率的联系

先看似然函数的定义。关于参数$\theta$的似然函数$L(\theta|data)$（在数值上）等于给定参数$\theta$后变量$data$的概率（两者的相等并不是说两个函数是同一个，只是数值上的相等，如果还不理解这个定义为什么是这样，可以先跳过往下看）：
$$
L(\theta|data) = P(data|\theta) = \prod_{i=1}^NP(x_i|\theta)     
\\
data = (x_1,x_2,...,x_n)
$$
存在两个疑问：

1. 似然函数 (likelihood function) 为什么会写成条件概率的形式？
2. 给定的明明是$data$，为什么公式的右边，却变成了给定 $\theta$ 呢？

**常说的概率是指给定参数后，预测即将发生的事件的可能性**。拿硬币这个例子来说，我们已知一枚均匀硬币的正反面概率分别是0.5($p = p_H = p_ T = 0.5$)，要预测抛两次硬币，正面都朝上的概率：

H代表Head，表示正面朝上

也就是$data = (x_1,x_2) = (H,H)$
$$
P(HH | p = 0.5) = \prod_{i=1}^2 P(x_i|p=0.5) = 0.5*0.5 = 0.25
$$
这种写法其实有点误导，后面的这个$p$其实是作为参数存在的（其实用$\theta$表示参数更好看一些，但是这里还要表示硬币正面朝上的概率，所以就先用$p$来做表示），而不是一个随机变量，因此不能算作是条件概率，更靠谱的写法应该是 $P(HH;p=0.5)$，分号`;`表示把参数隔开。平常求概率的时候是不写参数的，因为参数（硬币正面朝上的概率）是确定的，但这里是在讲解似然函数，参数是似然函数最终要求得的结果，所以这里就显式表明了参数的取值。比如，在其他参数取值下，可以写成$P(HH | p = 0.4) = 0.4*0.4 = 0.16$。

**似然概率正好与这个过程相反，我们关注的量不再是事件的发生概率，而是已知发生了某些事件，我们希望知道参数应该是多少。**

现在我们已经抛了两次硬币，并且知道了结果是两次正面朝上，这时候，我希望知道这枚硬币抛出去正面朝上的概率为0.5的概率是多少？正面朝上的概率为0.8的概率是多少？（这里的0.5和0.8就是之前提到的参数）

如果我们希望知道正面朝上概率为0.5的概率，这个东西就叫做似然函数，可以说成是对某一个参数的猜想（$p=0.5$）的概率，这样表示成(条件)概率就是
$$
L(p=0.5|HH) = P(HH|p=0.5) = P(HH;p=0.5)
$$
为什么可以写成这样？我觉得可以这样来想：

似然函数本身也是一种概率，我们可以把$L(p=0.5|HH)$写成$P(p=0.5|HH)$； 而根据贝叶斯公式，$P(p=0.5|HH) = P(p=0.5,HH)/P(HH)$；既然$HH$是已经发生的事件，理所当然$P(HH) = 1$,所以：
$$
P(p=0.5|HH) = P(p=0.5,HH) = P(HH;p=0.5)
$$
右边的这个计算我们很熟悉了，就是已知正面朝上概率为0.5，求抛两次都是H的概率，即0.5*0.5=0.25。

所以，我们可以得到
$$
L(p=0.5|HH) = P(HH|p=0.5) = 0.25
$$
这个0.25的意思是，在已知抛出两个正面的情况下，$p = 0.5$的概率等于0.25。

再算一下
$$
L(p=0.6|HH) = P(HH|p=0.6) = 0.36
$$
把p从0~1的取值所得到的似然函数的曲线画出来得到这样一张图：

![image](https://note.youdao.com/yws/public/resource/ef8a8e89c349f242af1b62f2240b9c10/xmlnote/DB196ADB7C98434F8A10D427FEA64F96/2713)

可以发现，$p = 1$的概率是最大的。

即$L(p = 1|HH) = 1$。

那么极大似然估计的问题也就好理解了（之后会有一篇单独文章）。

极大似然估计，就是在已知观测的数据的前提下，找到使得似然概率最大的参数值。

这就不难理解，在数据挖掘领域，许多求参数的方法最终都归结为极大似然估计的问题。

回到这个硬币的例子上来，在观测到HH的情况下，$p = 1$是最合理的（却未必符合真实情况，因为数据量太少的缘故）。

希望大家看到这里，可以明白似然函数为什么这样定义，还不明白就记住它吧，毕竟定义是定死的。

#### 3. 似然函数遇到离散和连续数据两种情况

##### 3.1 $x_1,x_2,...,x_n$是离散数据

上面关于硬币的例子就是离散型数据。此时可以具体给出$P_\theta(x_i)$的值，即代表在给定参数$\theta$下取得$x_i$的概率。
$$
L(\theta|data) = P(data|\theta) = P(data;\theta) = P_\theta(data) = \prod_{i=1}^NP_\theta(x_i)     
\\
data = (x_1,x_2,...x_i,...,x_n)
$$
使用上式就可以求出给定参数$\theta$和$data$时，离散型随机变量对应的似然。

如果我们发现
$$
L(\theta_1|data) = P_{\theta_1}(data) = \prod_{i=1}^NP_{\theta_1}(x_i)   > \prod_{i=1}^NP_{\theta_2}(x_i) = P_{\theta_2}(data) = L(\theta_2|data)
$$
那么似然函数就反应出这样一个朴素推测：在参数$\theta_1$下随机向量$data$取到值$(x_1,x_2,...,x_n)$的可能性大于 在参数$\theta_2$下随机向量$data$取到值$(x_1,x_2,...,x_n)$的可能性。换句话说，我们更有理由相信(相对于$\theta_2$来说)$\theta_1$更有可能是真实值。这里的可能性由概率来刻画。

##### 3.2 $x_1,x_2,...,x_n$是连续数据

因为是连续型数据，所以无法给出$P_\theta(x_i)$的值或者说$P_\theta(x_i)$的值为零，而可以给出的是概率密度$f$，也就是一个区间内的概率。给定一个充分小$\epsilon > 0$，那么随机变量$x_i$取值在$(x - \epsilon, x + \epsilon)$区间内的概率即为
$$
P_{\theta}(x-\epsilon < x_i < x+\epsilon) = \int_{x-\epsilon}^{x+\epsilon}f(x_i|\theta)dx \approx 2\epsilon f(x_i|\theta) = 2\epsilon P(x_i|\theta) = 2\epsilon L(\theta|x_i)
$$
建立了似然函数和概率之间的关系，就可以像离散型变量一样，比较两个参数的似然，得到一个推测，如下所示。
$$
L(\theta_1|data) \propto  P_{\theta_1}(data) \propto \prod_{i=1}^NP_{\theta_1}(x-\epsilon <x_i< x+\epsilon) 

>

\prod_{i=1}^NP_{\theta_2}(x-\epsilon <x_i< x+\epsilon) \propto P_{\theta_2}(data) \propto L(\theta_2|data)
$$
推测：在参数$\theta_1$下随机向量$data$取到值$(x_1,x_2,...,x_n)$的可能性大于 在参数$\theta_2$下随机向量$data$取到值$(x_1,x_2,...,x_n)$的可能性。

综上，概率(密度)表达给定$\theta$下取得$data$的可能性，而似然表达了给定$data$下参数$\theta_1$(相对于另外的参数$\theta_2$)为真实值的可能性。

